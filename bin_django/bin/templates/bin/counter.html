<!DOCTYPE html>
<html>
    <head>
        <!--Import Google Icon Font-->
        <!-- material-icons.css -->
        
        <!-- materialize.min.css -->

        <!-- jquery.lineProgressbar.min.css -->

        <!-- style.css -->

        <!--Let browser know website is optimized for mobile-->
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Scoreboard</title>
    </head>


    <body class="grey lighten-4 grey-text text-darken-4 z-depth-0">
        <div class="container">
        <nav>
            <div class="nav-wrapper teal">
                <!-- <div class="container"> -->
                <a href="/" class="brand-logo center"><strong>Leadboard</strong></a>
                <ul id="nav-mobile" class="right">
                    <li>
                    <a href="register">Register</a>
                    </li>
                </ul>

                <ul id="nav-mobile" class="left">
                    <li>
                    <a class="modal-trigger" href="#modal1">Bin Status</a>
                    </li>
                </ul>
                
                <!-- </div> -->
            </div>
        </nav>

        <!-- MODAL -->
        <div id="modal1" class="modal">
            <div class="modal-content">
                <h4 class="center">Bin Status</h4>
                <div class="row">
                    <div style="margin-top:15px;" class="col s1">
                        <span><strong>Bin #1</strong></span>
                    </div>
                    <div class="col s11">
                        <div id="binOne"></div>
                    </div>

                    <div style="margin-top:15px;" class="col s1">
                        <span><strong>Bin #2</strong></span>
                    </div>
                    <div class="col s11">
                        <div id="binTwo"></div>
                    </div>

                    <div style="margin-top:15px;" class="col s1">
                        <span><strong>Bin #3</strong></span>
                    </div>
                    <div class="col s11">
                        <div id="binThree"></div>
                    </div>
                </div>
                
                
                
            </div>
            <div class="modal-footer">
                <a class="modal-action modal-close waves-effect waves-green btn-flat">Ok</a>
            </div>
        </div>

        <h4 class="center">Please Wait...</h4>
        <div class="cntr-container"></div>
                
        </div>

        <div style="padding:50px;"></div>

    <!--Import jQuery -->
    <!-- jquery-3.2.1.min.js -->
    <!-- Materialize -->
    <!-- materialize.min.js -->
    <!-- Socket IO -->
    <!-- socket.io.min.js -->
    <!-- Progressbar -->
    <!-- jquery.lineProgressbar.js -->

    <!-- js/d3.min.js -->

    <!-- js/index.js -->

    <script>
        $(document).ready(function () {
            //connect to the socket server.
            var socket = io.connect('http://' + document.domain + ':' + location.port + '/test');
            var numbers_received = [];


            //receive bin status from server
            socket.on('bin_stat', function(msg) {
                //console.log("Received Data: " + msg.bin_stat + "    Bid ID: " + msg.bin_id);
                updateBinStat(msg.bin_id, msg.bin_stat)
                //location.reload();
                //maintain a list of ten numbers
            });


            // JAVASCRIPT START HERE //
            $('.modal').modal({
                dismissible: true,
                inDuration: 300,
                outDuration: 200,
                ready: function (modal, trigger) {
                }
            });


            // Progressbar
            $('#binOne').LineProgressbar({
                percentage: 0,
                fillBackgroundColor: '#1eb6e0',
                height: '35px'
            });
            $('#binTwo').LineProgressbar({
                percentage: 0,
                fillBackgroundColor: '#1d68e0',
                height: '35px'
            });
            $('#binThree').LineProgressbar({
                percentage: 0,
                fillBackgroundColor: '#a21ce0',
                height: '35px'
            });
        });
    </script>

    <script>
        function updateBinStat(binId, val){
            switch(binId) {
                case "1":
                    $('#binOne').LineProgressbar({
                        percentage: val,
                        fillBackgroundColor: '#1eb6e0',
                        height: '35px'
                    });
                    break;
                case "2":
                    $('#binTwo').LineProgressbar({
                        percentage: val,
                        fillBackgroundColor: '#1d68e0',
                        height: '35px'
                    });
                    break;
                case "3":
                    $('#binThree').LineProgressbar({
                        percentage: val,
                        fillBackgroundColor: '#a21ce0',
                        height: '35px'
                    });
                    break;
                default:
                    text = "Wrong Bin ID";
                }
        }
    </script>

    {% if msg != '' %}
    <script>
        Materialize.toast('{{ msg }}', 8000, 'rounded');
    </script>
    {% endif %}
    </body>
</html>
